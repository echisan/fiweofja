# 术语

- Topic 主题
- Producer 生产者
- Consumer 消费者

可以把生产者和消费者统称为客户端(Clients)



## Replication备份机制

把相同的数据拷贝到多台机器上，这些相同的数据拷贝在kafka中被称为副本(Replica)

Kafka定义了两类副本：领导者副本(Leader Replica)和追随者副本(Follower Replica)，前者对外提供服务(与客户端程序进行交互)，后者只是被动地追随领导者副本，不能与外界进行交互。

## Scalability伸缩性

分区机制 Partitioning， 将每个主题划分成多个分区(Partition)，每个分区是一组有序的消息日志。生产者生产的每条消息只会被发送到一个分区中。

生产者向分区写入消息，每条消息在分区中的位置信息由一个叫位移(Offset)的数据来表征。分区位移总是从0开始。



> 至此我们能够完整地串联起 Kafka 的三层消息架构：
>
> - 第一层是主题层，每个主题可以配置 M 个分区，而每个分区又可以配置 N 个副本。
>
> - 第二层是分区层，每个分区的 N 个副本中只能有一个充当领导者角色，对外提供服务；
>
>   其他 N-1 个副本是追随者副本，只是提供数据冗余之用。
>
> - 第三层是消息层，分区中包含若干条消息，每条消息的位移从 0 开始，依次递增。
>
>   最后，客户端程序只能与分区的领导者副本进行交互。



## 日志段Log Segment机制

定时删除消息以回收磁盘，通过日志段机制。在kafka底层，一个日志又进一步细分成多个日志段，消息被追加写到当前最新的日志段中，写满一个日志段后，kafka会自动切分出一个新的日志段，并将老的日志段封存起来。kafka后台还有定时任务会定期检查老的日志段是否能够被删除，从而实现回收磁盘空间的目的。

## 消费者组

指多个消费者实例共同组成一个组来消费一组主题。这组主题中的每个分区都只会被组内的一个消费者实例消费，其他消费者实例不能消费它。

引入消费者组主要是为了提升消费者端的吞吐量，多个消费者实例同时消费，加速整个消费端的吞吐量(TPS)























